<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Shitstorm-Simulation – Start</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color-scheme: light;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #bfdbfe, #e5e7eb 55%);
      color: #111827;
    }

    .card {
      background: #ffffff;
      border-radius: 1rem;
      padding: 1.7rem 1.9rem;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.18);
      border: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 1.1rem;
      width: min(520px, 100% - 2rem);
    }

    .title {
      font-size: 1.25rem;
      font-weight: 600;
      text-align: center;
      color: #111827;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #4b5563;
      text-align: center;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 0.9rem;
    }

    label {
      font-size: 0.8rem;
      color: #4b5563;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    select,
    input,
    textarea {
      border-radius: 0.75rem;
      border: 1px solid #cbd5f5;
      background: #f9fafb;
      color: #111827;
      padding: 0.55rem 0.75rem;
      font: inherit;
      font-size: 0.9rem;
      outline: none;
      box-sizing: border-box;
    }

    select:focus,
    input:focus,
    textarea:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.35);
      background: #ffffff;
    }

    textarea {
      resize: none;          /* Höhe steuern wir per JS */
      min-height: 2.6rem;
      max-height: 220px;     /* Sicherheitsnetz, echte Höhe per JS */
      line-height: 1.3;
    }

    .row {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .row > label {
      flex: 1 1 160px;
    }

    .hint {
      font-size: 0.78rem;
      color: #6b7280;
    }

    button {
      margin-top: 0.2rem;
      border: none;
      border-radius: 999px;
      padding: 0.6rem 1rem;
      font: inherit;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #3b82f6, #22c55e);
      color: #ffffff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.3rem;
    }

    button:hover {
      filter: brightness(1.05);
    }

    .platform-row {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .platform-row small {
      font-size: 0.75rem;
      color: #6b7280;
    }

    /* YouTube-Felder: untereinander */
    .yt-extra {
      display: none;          /* wird per JS auf "flex" gesetzt */
      flex-direction: column; /* immer untereinander */
      gap: 0.75rem;
    }

    .yt-extra > label {
      width: 100%;            /* jeweils volle Breite */
    }
  </style>
</head>
<body>
  <div class="card">
    <div>
      <div class="title">Shitstorm-Simulation starten</div>
      <div class="subtitle">
        Definiere die Ausgangslage und wähle die Plattform, auf der du trainieren willst.
      </div>
    </div>

    <form id="setupForm">
      <div class="platform-row">
        <label>
          Plattform
          <select id="platformSelect" required>
            <option value="">Bitte wählen …</option>
            <option value="x">Twitter X</option>
            <option value="instagram">Instagram</option>
            <option value="facebook">Facebook</option>
            <option value="youtube">YouTube</option>
          </select>
        </label>
        <small>
          Je nach Auswahl wirst du auf <code>x.html</code>, <code>instagram.html</code>,
          <code>facebook.html</code> oder <code>youtube.html</code> geleitet.
        </small>
      </div>

      <div class="row">
        <label>
          Unternehmen
          <input
            id="companyInput"
            placeholder="z.B. Dein Unternehmen GmbH"
            value="Dein Unternehmen"
          />
        </label>
      </div>

      <!-- Standard-Fall: Ursache als freier Text (wird zum Auslöser-Post) -->
      <label id="causeLabel">
        Ursache des Shitstorms (wird als Post angezeigt)
        <textarea
          id="causeInput"
          placeholder="z.B. &quot;Ich finde es unfassbar, dass ...&quot;"
          data-autoresize
        >Unangemessene Werbekampagne</textarea>
      </label>

      <!-- YouTube-Spezialfall: Video-Titel + Video-Inhalt -->
      <div class="yt-extra" id="youtubeFields">
        <label>
          Titel des Videos
          <input
            id="ytTitleInput"
            placeholder="z.B. &quot;Skandal bei &lt;Unternehmen&gt;&quot;"
          />
        </label>
        <label>
          Inhalt des Videos (Kurzbeschreibung)
          <textarea
            id="ytContentInput"
            placeholder="Was passiert im Video? Warum sind die Leute wütend?"
            data-autoresize
          ></textarea>
        </label>
      </div>

      <div class="hint">
        Die Ursache wird auf der gewählten Plattform als Post dargestellt –
        bei YouTube als Kombination aus Video-Titel und Video-Inhalt.
        Die Simulation startet mit Intensität 70/100 und versucht, unter 10 zu kommen,
        bevor die Lage über 90 explodiert.
      </div>

      <button type="submit">Simulation starten</button>
    </form>
  </div>

  <script>
    const form = document.getElementById("setupForm");
    const platformSelect = document.getElementById("platformSelect");
    const companyInput = document.getElementById("companyInput");
    const causeLabel = document.getElementById("causeLabel");
    const causeInput = document.getElementById("causeInput");
    const ytFields = document.getElementById("youtubeFields");
    const ytTitleInput = document.getElementById("ytTitleInput");
    const ytContentInput = document.getElementById("ytContentInput");

    // ---------- Textareas automatisch an Inhalt anpassen ----------
    function autoResizeTextarea(el) {
      const max = parseInt(el.dataset.maxHeight || "220", 10);
      el.style.height = "auto";
      const newHeight = Math.min(el.scrollHeight, max);
      el.style.height = newHeight + "px";
    }

    function initAutoResize() {
      document.querySelectorAll("textarea[data-autoresize]").forEach((ta) => {
        autoResizeTextarea(ta);
        ta.addEventListener("input", () => autoResizeTextarea(ta));
      });
    }

    // ---------- Felder je nach Plattform umschalten ----------
    function updatePlatformFields() {
      const platform = platformSelect.value;
      if (platform === "youtube") {
        causeLabel.style.display = "none";
        ytFields.style.display = "flex";
      } else {
        causeLabel.style.display = "flex";
        ytFields.style.display = "none";
      }
      initAutoResize();
    }

    platformSelect.addEventListener("change", updatePlatformFields);

    // ---------- Formular-Submit / Navigation ----------
    form.addEventListener("submit", (event) => {
      event.preventDefault();

      const platform = platformSelect.value;
      if (!platform) {
        alert("Bitte eine Plattform auswählen.");
        return;
      }

      const company = companyInput.value.trim();

      let target;
      switch (platform) {
        case "x":
          target = "x.html";
          break;
        case "instagram":
          target = "instagram.html";
          break;
        case "facebook":
          target = "facebook.html";
          break;
        case "youtube":
          target = "youtube.html";
          break;
        default:
          alert("Unbekannte Plattform.");
          return;
      }

      const params = new URLSearchParams();
      if (company) params.set("company", company);

      if (platform === "youtube") {
        const title = ytTitleInput.value.trim();
        const content = ytContentInput.value.trim();
        const combined = [title, content].filter(Boolean).join(" – ");
        if (combined) params.set("cause", combined);
        if (title) params.set("videoTitle", title);
        if (content) params.set("videoContent", content);
      } else {
        const cause = causeInput.value.trim();
        if (cause) params.set("cause", cause);
      }

      params.set("auto", "1");

      const url = params.toString() ? `${target}?${params.toString()}` : target;
      window.location.href = url;
    });

    // ---------- Initialisierung ----------
    document.addEventListener("DOMContentLoaded", () => {
      initAutoResize();
      updatePlatformFields();
    });
  </script>
</body>
</html>
